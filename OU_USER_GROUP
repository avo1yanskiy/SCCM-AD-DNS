# OU Create #
New-ADOrganizationalUnit -Name "Moscow" -Path "dc=m24,dc=etc"
New-ADOrganizationalUnit -Name "Server" -Path "OU=Moscow, dc=m24,dc=etc"
New-ADOrganizationalUnit -Name "Hyper-v" -Path "OU=Moscow, dc=m24,dc=etc"
New-ADOrganizationalUnit -Name "Application" -Path "OU=Moscow, dc=m24,dc=etc"
New-ADOrganizationalUnit -Name "AdminUsers" -Path "OU=Moscow, dc=m24,dc=etc"
New-ADOrganizationalUnit -Name "ServiceUsers" -Path "OU=Moscow, dc=m24,dc=etc"
New-ADOrganizationalUnit -Name "Group" -Path "OU=Moscow, dc=m24,dc=etc"



#Group Create#

New-ADGroup -Name "Admins" -SamAccountName "Admins" -GroupScope Global -GroupCategory Security -Description "Admins_Group" -Path "OU=Group, OU=Moscow, dc=m24,dc=etc"
New-ADGroup -Name "SQL" -SamAccountName "SQL" -GroupScope Global -GroupCategory Security -Description "Admins_SQl" -Path "OU=Group, OU=Moscow, dc=m24,dc=etc"
New-ADGroup -Name "Hyper-v" -SamAccountName "Hyper-v" -GroupScope Global -GroupCategory Security -Description "Admins_Hyper-v" -Path "OU=Group, OU=Moscow, dc=m24,dc=etc"
New-ADGroup -Name "Application" -SamAccountName "Application" -GroupScope Global -GroupCategory Security -Description "Admins_Application" -Path "OU=Group, OU=Moscow, dc=m24,dc=etc"

# User Add & SecPass #

$pass = ConvertTo-SecureString -String "Qwerty123!" -AsPlainText -Force
New-ADUser -Name "Admin" -UserPrincipalName "admin" -SamAccountName "admin" -GivenName "Admin" -Surname "IT" -DisplayName "Admin IT" -AccountPassword $pass -CannotChangePassword $false -Enabled $true -Path "OU=AdminUsers, OU=Moscow, dc=m24, dc=etc"


# add group users #

Add-ADGroupMember "Администраторы домена" admin
